# postgres:17 ì´ë¯¸ì§€ ê¸°ë°˜
# Description : Dockerfile.db - ğŸ“Œ db docker build
# Author : Shiwoo Min
# Date : 2025-09-06
# 09/06 - ë„ì»¤ ë¹Œë“œ í…ŒìŠ¤íŠ¸: docker compose -f infra/docker/docker-compose.yml build postgres

# ì»¤ìŠ¤í…€ Postgres ì´ë¯¸ì§€
FROM postgres:17

# íƒ€ì„ì¡´ ì„¤ì •
ENV TZ=Asia/Seoul

# ì„¤ì • íŒŒì¼ ë³µì‚¬
COPY infra/database/conf/pg_hba.conf /etc/postgresql/pg_hba.conf
COPY infra/database/conf/postgresql.conf /etc/postgresql/postgresql.conf

# ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬
COPY infra/database/init/ /docker-entrypoint-initdb.d/

# í¼ë¯¸ì…˜(ë³´ìˆ˜ì ; init ìŠ¤í¬ë¦½íŠ¸ê°€ .shë¼ë©´ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬)
RUN mkdir -p /var/lib/postgresql/data/pg_log && \
    chown -R postgres:postgres /var/lib/postgresql/data/pg_log

